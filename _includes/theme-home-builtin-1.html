<!-- Home page design with small circular image bisecting card. -->

{% assign essay_pages = site.pages | where: "type", "essay" | where_exp: "page", "page.draft != true" %}
{% assign paper_pages = site.pages | where: "type", "paper" | where_exp: "page", "page.draft != true" %}
{% assign project_pages = site.pages | where: "type", "project" | where_exp: "page", "page.draft != true" %}
{% assign num_essays = essay_pages.size %}
{% assign num_papers = paper_pages.size %}
{% assign num_projects = project_pages.size %}

<div class="main-layout-container">
  <div style="height: 100%; margin-top: 0px; margin-bottom: 0px" class="ui middle aligned grid main-card-container">

    <div class="column">

      <div style="position: relative; top: 75px; z-index: 1" class="ui fluid centered small circular image">
        <img src="{{ site.data.bio.basics.picture }}">
      </div>


      <div style="max-width: 550px; padding-top: 75px; margin-top: 0px; width: 550px;" class="ui centered card">

        <div class="center aligned content">
          <span class="header">{{ site.data.bio.basics.name }}</span>
          <div class="meta">
            <span class="date">{{ site.data.bio.basics.label }}</span>
          </div>
          <div class="left aligned description">
            {{ site.data.bio.basics.summary }}
          </div>
        </div>
        <div class="center aligned content">
          <div class="description">
            Interests:
            {% for interest in site.data.bio.interests %}
            {{ interest.name }}{% if forloop.last != true %}, {% endif %}
            {% endfor %}

          </div>
        </div>
        <div class="center aligned extra content">
          {% include home-network-links.html %}
        </div>
        <div class="center aligned content homepage-buttons-container">
          <button class="ui basic button tab-button" data-tab="projects">Projects ({{ num_projects }})</button>
          <button class="ui basic button tab-button" data-tab="papers">Papers ({{ num_papers }})</button>
          <button class="ui basic button tab-button" data-tab="essays">Essays ({{ num_essays }})</button>
          <button class="ui basic button tab-button" data-tab="bio">{{ site.bio-page-label }}</button>
          <button class="ui basic button dark-mode-toggle" onclick="toggleDarkMode()" title="Toggle Dark Mode">
            <span class="theme-text">Light Mode</span> <i class="lightbulb icon"></i>
          </button>
        </div>
      </div>
    </div>

  </div>

  <!-- Tab content sections - positioned relative to the card -->
  <div id="tab-content" class="ui container tab-content-container">

  <section id="projects-tab" class="tab-content" style="display: none;">
    <h2 class="ui center aligned header">Projects</h2>
    {% include content-projects.html %}

    <!-- Individual project content sections -->
    {% assign project_pages = site.pages | where: "type", "project" | sort: "date" | reverse %}
    {% for page in project_pages %}
    {% unless page.draft %}
    <div id="project-{{ page.title | slugify }}" class="project-content" style="display: none;">
      <div class="ui basic button back-to-projects" onclick="showProjectsList()">
        <i class="arrow left icon"></i> Back to Projects
      </div>
      <div class="project-detail-header">
        <h2 class="ui center aligned header">{{ page.title }}</h2>
        <div class="project-meta">
          <span class="date">{{ page.date | date: "%B %d, %Y" }}</span>
        </div>
      </div>

      <div class="project-content-body">
        {{ page.content }}
      </div>

      {% if page.projecturl %}
      <div class="project-actions">
        <a class="ui button" href="{{ page.projecturl }}" target="_blank">
          <i class="external link icon"></i> View Project
        </a>
      </div>
      {% endif %}
    </div>
    {% endunless %}
    {% endfor %}
  </section>

  <section id="papers-tab" class="tab-content" style="display: none;">
    <h2 class="ui center aligned header">Papers</h2>
    {% include content-papers.html %}

    <!-- Individual paper content sections -->
    {% assign paper_pages = site.pages | where: "type", "paper" | sort: "date" | reverse %}
    {% for page in paper_pages %}
    {% unless page.draft %}
    <div id="paper-{{ page.title | slugify }}" class="paper-content" style="display: none;">
      <div class="ui basic button back-to-papers" onclick="showPapersList()">
        <i class="arrow left icon"></i> Back to Papers
      </div>

      <div class="project-content-body">
        {{ page.content }}
      </div>

      {% if page.pdf %}
      <div class="project-actions">
        <a class="ui button" href="{{ site.baseurl }}{{ page.pdf }}" target="_blank">
          <i class="download icon"></i> Download PDF
        </a>
      </div>
      {% endif %}
    </div>
    {% endunless %}
    {% endfor %}
  </section>

  <section id="essays-tab" class="tab-content" style="display: none;">
    <h2 class="ui center aligned header">Essays</h2>
    {% include content-essays.html %}

    <!-- Individual essay content sections -->
    {% assign essay_pages = site.pages | where: "type", "essay" | sort: "date" | reverse %}
    {% for page in essay_pages %}
    {% unless page.draft %}
    <div id="essay-{{ page.title | slugify }}" class="essay-content" style="display: none;">
      <div class="ui basic button back-to-essays" onclick="showEssaysList()">
        <i class="arrow left icon"></i> Back to Essays
      </div>
      <div class="project-detail-header">
        <h2 class="ui center aligned header">{{ page.title }}</h2>
        <div class="project-meta">
          <span class="date">{{ page.date | date: "%B %d, %Y" }}</span>
        </div>
      </div>

      <div class="project-content-body">
        {{ page.content }}
      </div>
    </div>
    {% endunless %}
    {% endfor %}
  </section>

  <section id="bio-tab" class="tab-content" style="display: none;">
    {% include content-bio.html %}
  </section>

  </div>
</div>

<style>
  /* Main layout container to control positioning */
  .main-layout-container {
    position: relative;
    min-height: 100vh;
  }
  /* Tab navigation styling - similar to dark mode toggle but with persistent active state */
  .homepage-buttons-container .tab-button {
    transition: all 0.2s ease !important;
    cursor: pointer !important;
    color: var(--text-primary) !important;
    border: 1px solid var(--border-color) !important;
  }

  .homepage-buttons-container .tab-button:hover {
    background-color: var(--cambridge-blue) !important;
    color: var(--english-violet) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 2px 8px var(--shadow-color) !important;
  }

  /* Focus and active states - reset immediately after click like dark mode toggle */
  .homepage-buttons-container .tab-button:focus:not(.active) {
    background-color: transparent !important;
    color: var(--text-primary) !important;
    border: 1px solid var(--border-color) !important;
    box-shadow: none !important;
    outline: none !important;
    transform: none !important;
  }

  .homepage-buttons-container .tab-button:active:not(.active) {
    background-color: transparent !important;
    color: var(--text-primary) !important;
    border: 1px solid var(--border-color) !important;
    box-shadow: none !important;
    transform: none !important;
  }

  /* Active tab button styling - persistent highlighting */
  .homepage-buttons-container .tab-button.active {
    background-color: var(--cambridge-blue) !important;
    color: var(--english-violet) !important;
    font-weight: bold !important;
    border: 1px solid var(--slate-gray) !important;
    box-shadow: 0 0 0 1px var(--cambridge-blue) !important;
  }

  .homepage-buttons-container .tab-button.active:hover {
    background-color: var(--slate-gray) !important;
    color: var(--honeydew) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 2px 8px var(--shadow-color) !important;
  }

  /* Ensure hover works even when active button has focus */
  .homepage-buttons-container .tab-button.active:focus:hover {
    background-color: var(--slate-gray) !important;
    color: var(--honeydew) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 2px 8px var(--shadow-color) !important;
  }

  /* Ensure active state is preserved during theme transitions */
  [data-theme="dark"] .homepage-buttons-container .tab-button.active,
  [data-theme="light"] .homepage-buttons-container .tab-button.active {
    background-color: var(--cambridge-blue) !important;
    color: var(--english-violet) !important;
    font-weight: bold !important;
    border: 2px solid var(--slate-gray) !important;
    box-shadow: 0 0 0 1px var(--cambridge-blue) !important;
  }

  /* Dark mode toggle button - consistent dimensions */
  .homepage-buttons-container .dark-mode-toggle {
    cursor: pointer !important;
    transition: all 0.2s ease;
    border: 2px solid transparent !important;
    box-sizing: border-box !important;
    min-width: 120px !important;
    padding: 8px 12px !important;
  }

  .homepage-buttons-container .dark-mode-toggle:hover {
    background-color: var(--cambridge-blue) !important;
    color: var(--english-violet) !important;
    transform: translateY(-1px);
    box-shadow: 0 2px 8px var(--shadow-color);
  }

  /* Prevent dark mode toggle from staying highlighted after click */
  .homepage-buttons-container .dark-mode-toggle:focus {
    background-color: transparent !important;
    color: inherit !important;
    transform: none !important;
    box-shadow: none !important;
    outline: none !important;
  }

  .homepage-buttons-container .dark-mode-toggle:active {
    background-color: transparent !important;
    color: inherit !important;
    transform: none !important;
    box-shadow: none !important;
  }

  /* Ensure dark mode toggle never gets the active class styling */
  .homepage-buttons-container .dark-mode-toggle.active {
    background-color: transparent !important;
    color: inherit !important;
    font-weight: normal !important;
    transform: none !important;
    box-shadow: none !important;
  }

  /* Tab content styling - positioned relative to card with consistent spacing */
  #tab-content {
    background-color: transparent !important;
    display: none;
    /* Hidden by default when no tabs are active */
    position: relative;
    margin-top: 40px !important;
    width: 100%;
    max-width: 1200px;
    margin-left: auto;
    margin-right: auto;
  }

  #tab-content.has-active-tab {
    display: block;
    /* Show when a tab is active */
  }

  .tab-content {
    animation: fadeIn 0.3s ease-in-out;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }

    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .tab-content .ui.header {
    color: var(--text-primary) !important;
    margin-bottom: 30px !important;
    margin-top: 0px !important;
  }

  /* Ensure all cards in tab content inherit theme and maintain fixed sizes */
  .tab-content .ui.card {
    background-color: var(--bg-secondary) !important;
    border: 1px solid var(--border-color) !important;
    box-shadow: 0 2px 8px var(--shadow-color) !important;
    width: 280px !important;
    min-width: 280px !important;
    max-width: 280px !important;
  }

  /* Override Semantic UI responsive card behavior */
  /* .tab-content .ui.cards {
    display: flex !important;
    justify-content: center !important;
    flex-wrap: wrap !important;
  }

  .tab-content .ui.cards > .card {
    width: 280px !important;
    min-width: 280px !important;
    max-width: 280px !important;
    margin: 0.875em 0.5em !important;
  } */

  .tab-content .ui.card .header {
    color: var(--text-primary) !important;
  }

  .tab-content .ui.card .meta {
    color: var(--text-secondary) !important;
  }

  .tab-content .ui.card .description {
    color: var(--text-primary) !important;
  }

  /* Buttons in tab content */
  .tab-content .ui.button {
    background-color: var(--cambridge-blue) !important;
    color: var(--english-violet) !important;
    border: 1px solid var(--slate-gray) !important;
  }

  .tab-content .ui.button:hover {
    background-color: var(--slate-gray) !important;
    color: var(--honeydew) !important;
  }

  .tab-content .ui.basic.button {
    background-color: transparent !important;
    color: var(--text-primary) !important;
    border: 1px solid var(--border-color) !important;
  }

  .tab-content .ui.basic.button:hover {
    background-color: var(--cambridge-blue) !important;
    color: var(--english-violet) !important;
  }

  /* Project content styling */
  .project-content {
    animation: fadeIn 0.3s ease-in-out;
    padding: 20px 0;
    width: 100% !important;
  }

  .project-detail-container {
    max-width: 1000px !important;
    margin: 0 auto !important;
    padding: 0 20px !important;
    background-color: var(--bg-secondary) !important;
    border-radius: 8px !important;
    box-shadow: 0 2px 8px var(--shadow-color) !important;
  }

  .project-detail-header {
    text-align: center !important;
    padding: 30px 0 20px 0 !important;
    border-bottom: 1px solid var(--border-color) !important;
    margin-bottom: 30px !important;
  }

  .project-meta {
    margin-top: 15px !important;
  }

  .project-meta .date {
    color: var(--text-secondary) !important;
    font-size: 1.1em !important;
    display: block !important;
  }

  .project-content-body {
    line-height: 1.7 !important;
    font-size: 1.1em !important;
    color: var(--text-primary) !important;
    padding: 0 20px !important;
    text-align: left !important;
  }

  .project-content-body h2 {
    color: var(--text-primary) !important;
    margin-top: 40px !important;
    margin-bottom: 20px !important;
    border-bottom: 2px solid var(--cambridge-blue) !important;
    padding-bottom: 10px !important;
  }

  .project-content-body p {
    margin-bottom: 20px !important;
  }

  .project-content-body img {
    max-width: 100% !important;
    height: auto !important;
    margin: 20px 0 !important;
    border-radius: 4px !important;
    box-shadow: 0 2px 8px var(--shadow-color) !important;
  }

  .project-content-body pre {
    background-color: var(--bg-primary) !important;
    border: 1px solid var(--border-color) !important;
    border-radius: 4px !important;
    padding: 15px !important;
    overflow-x: auto !important;
    margin: 20px 0 !important;
  }

  .project-actions {
    text-align: center !important;
    padding: 30px 0 !important;
    border-top: 1px solid var(--border-color) !important;
    margin-top: 40px !important;
  }

  .back-to-projects {
    margin-bottom: 20px !important;
    transition: all 0.2s ease !important;
  }

  .back-to-projects:hover {
    transform: translateX(-3px) !important;
  }

  /* Paper content styling - reuse project styles */
  .paper-content {
    animation: fadeIn 0.3s ease-in-out;
    padding: 20px 0;
    width: 100% !important;
  }

  .back-to-papers {
    margin-bottom: 20px !important;
    transition: all 0.2s ease !important;
  }

  .back-to-papers:hover {
    transform: translateX(-3px) !important;
  }

  /* PDF container styling for papers */
  .paper-content .pdf-container {
    margin: 30px 0 !important;
    text-align: center !important;
  }

  .paper-content .pdf-container iframe {
    width: 100% !important;
    height: 600px !important;
    border: 1px solid var(--border-color) !important;
    border-radius: 8px !important;
    box-shadow: 0 4px 12px var(--shadow-color) !important;
  }

  /* Responsive adjustments for project and paper content */
  @media (max-width: 768px) {
    /* Main card responsive adjustments */
    .ui.centered.card {
      width: calc(100vw - 40px) !important;
      max-width: calc(100vw - 40px) !important;
      margin: 0 20px !important;
    }

    /* Tab content cards responsive adjustments */
    .tab-content .ui.card,
    .tab-content .ui.cards > .card {
      width: calc(100vw - 60px) !important;
      min-width: calc(100vw - 60px) !important;
      max-width: calc(100vw - 60px) !important;
      margin: 0.875em 10px !important;
    }

    .project-detail-container {
      margin: 0 10px !important;
      padding: 0 15px !important;
    }

    .project-content-body {
      padding: 0 10px !important;
      font-size: 1em !important;
    }

    .paper-content .pdf-container iframe {
      height: 400px !important;
    }
  }

  @media (min-width: 769px) {
    /* Ensure main card stays fixed width on larger screens */
    .ui.centered.card {
      width: 550px !important;
      max-width: 550px !important;
    }
  }

  /* Essay content styling - reuse project styles */
  .essay-content {
    animation: fadeIn 0.3s ease-in-out;
    padding: 20px 0;
    width: 100% !important;
  }

  .back-to-essays {
    margin-bottom: 20px !important;
    transition: all 0.2s ease !important;
  }

  .back-to-essays:hover {
    transform: translateX(-3px) !important;
  }
</style>

<script>
  // Tab navigation functionality
  document.addEventListener('DOMContentLoaded', function () {
    const tabButtons = document.querySelectorAll('.tab-button');
    const tabContents = document.querySelectorAll('.tab-content');
    const tabContainer = document.getElementById('tab-content');

    tabButtons.forEach(button => {
      button.addEventListener('click', function () {
        const targetTab = this.getAttribute('data-tab');

        // Remove active class from all tab buttons (excluding dark mode toggle)
        tabButtons.forEach(btn => btn.classList.remove('active'));

        // Add active class to clicked button
        this.classList.add('active');

        // Blur the button to prevent focus styling (like dark mode toggle)
        this.blur();

        // Hide all tab contents
        tabContents.forEach(content => {
          content.style.display = 'none';
          content.classList.remove('active');
        });

        // Show target tab content and container
        const targetContent = document.getElementById(targetTab + '-tab');
        if (targetContent) {
          tabContainer.classList.add('has-active-tab');
          targetContent.style.display = 'block';
          targetContent.classList.add('active');
        }
      });
    });
  });

  // Project content display functionality
  function loadProject(projectUrl, projectTitle) {
    // Convert title to slug format for ID matching
    const projectSlug = projectTitle.toLowerCase()
      .replace(/[^a-z0-9\s-]/g, '')
      .replace(/\s+/g, '-')
      .replace(/-+/g, '-')
      .trim();

    const projectContentId = 'project-' + projectSlug;
    const projectContent = document.getElementById(projectContentId);

    if (projectContent) {
      // Hide the projects list with !important to override mobile CSS
      const projectsList = document.querySelector('#projects-tab .ui.cards');
      const projectsHeader = document.querySelector('#projects-tab h2');

      if (projectsList) {
        projectsList.style.setProperty('display', 'none', 'important');
      }
      if (projectsHeader) {
        projectsHeader.style.setProperty('display', 'none', 'important');
      }

      // Show the individual project content
      projectContent.style.display = 'block';
    }
  }

  function showProjectsList() {
    // Hide all project content sections
    const projectContents = document.querySelectorAll('.project-content');
    projectContents.forEach(content => {
      content.style.display = 'none';
    });

    // Show the projects list
    const projectsList = document.querySelector('#projects-tab .ui.cards');
    const projectsHeader = document.querySelector('#projects-tab h2');

    if (projectsList) {
      projectsList.style.setProperty('display', 'flex', 'important');
    }
    if (projectsHeader) {
      projectsHeader.style.setProperty('display', 'block', 'important');
    }
  }

  // Paper content display functionality
  function loadPaper(paperUrl, paperTitle) {
    // Convert title to slug format for ID matching
    const paperSlug = paperTitle.toLowerCase()
      .replace(/[^a-z0-9\s-]/g, '')
      .replace(/\s+/g, '-')
      .replace(/-+/g, '-')
      .trim();

    const paperContentId = 'paper-' + paperSlug;
    const paperContent = document.getElementById(paperContentId);

    if (paperContent) {
      // Hide the papers list
      const papersList = document.querySelector('#papers-tab .ui.cards');
      const papersHeader = document.querySelector('#papers-tab h2');

      if (papersList) papersList.style.setProperty('display', 'none', 'important');
      if (papersHeader) papersHeader.style.setProperty('display', 'none', 'important');

      // Show the individual paper content
      paperContent.style.display = 'block';
    } else {
      // Fallback to navigation if content section not found
      window.location.href = '{{ site.baseurl }}' + paperUrl;
    }
  }

  function showPapersList() {
    // Hide all paper content sections
    const paperContents = document.querySelectorAll('.paper-content');
    paperContents.forEach(content => {
      content.style.display = 'none';
    });

    // Show the papers list
    const papersList = document.querySelector('#papers-tab .ui.cards');
    const papersHeader = document.querySelector('#papers-tab h2');

    if (papersList) papersList.style.setProperty('display', 'flex', 'important');
    if (papersHeader) papersHeader.style.setProperty('display', 'block', 'important');
  }

  // Essay content display functionality
  function loadEssay(essayUrl, essayTitle) {
    // Convert title to slug format for ID matching
    const essaySlug = essayTitle.toLowerCase()
      .replace(/[^a-z0-9\s-]/g, '')
      .replace(/\s+/g, '-')
      .replace(/-+/g, '-')
      .trim();

    const essayContentId = 'essay-' + essaySlug;
    const essayContent = document.getElementById(essayContentId);

    if (essayContent) {
      // Hide the essays list
      const essaysList = document.querySelector('#essays-tab .ui.cards');
      const essaysHeader = document.querySelector('#essays-tab h2');

      if (essaysList) essaysList.style.setProperty('display', 'none', 'important');
      if (essaysHeader) essaysHeader.style.setProperty('display', 'none', 'important');

      // Show the individual essay content
      essayContent.style.display = 'block';
    } else {
      // Fallback to navigation if content section not found
      window.location.href = '{{ site.baseurl }}' + essayUrl;
    }
  }

  function showEssaysList() {
    // Hide all essay content sections
    const essayContents = document.querySelectorAll('.essay-content');
    essayContents.forEach(content => {
      content.style.display = 'none';
    });

    // Show the essays list
    const essaysList = document.querySelector('#essays-tab .ui.cards');
    const essaysHeader = document.querySelector('#essays-tab h2');

    if (essaysList) essaysList.style.setProperty('display', 'flex', 'important');
    if (essaysHeader) essaysHeader.style.setProperty('display', 'block', 'important');
  }
</script>