<!-- Home page design with small circular image bisecting card. -->

{% assign essay_pages = site.pages | where: "type", "essay" | where_exp: "page", "page.draft != true" %}
{% assign paper_pages = site.pages | where: "type", "paper" | where_exp: "page", "page.draft != true" %}
{% assign project_pages = site.pages | where: "type", "project" | where_exp: "page", "page.draft != true" %}
{% assign num_essays = essay_pages.size %}
{% assign num_papers = paper_pages.size %}
{% assign num_projects = project_pages.size %}

<div style="height: 100%; margin-top: -75px" class="ui middle aligned grid ">

  <div class="column">

    <div style="position: relative; top: 75px; z-index: 1" class="ui fluid centered small circular image">
      <img src="{{ site.data.bio.basics.picture }}">
    </div>


    <div style="max-width: 550px; padding-top: 75px; margin-top: 0px" class="ui fluid centered card">

      <div class="center aligned content">
        <span class="header">{{ site.data.bio.basics.name }}</span>
        <div class="meta">
          <span class="date">{{ site.data.bio.basics.label }}</span>
        </div>
        <div class="left aligned description">
          {{ site.data.bio.basics.summary }}
        </div>
      </div>
      <div class="center aligned content">
        <div class="description">
          Interests:
          {% for interest in site.data.bio.interests %}
          {{ interest.name }}{% if forloop.last != true %}, {% endif %}
          {% endfor %}

        </div>
      </div>
      <div class="center aligned extra content">
        {% include home-network-links.html %}
      </div>
      <div class="center aligned content homepage-buttons-container">
        <button class="ui basic button" onclick="loadSection('projects')">Projects ({{ num_projects }})</button>
        <button class="ui basic button" onclick="loadSection('papers')">Papers ({{ num_papers }})</button>
        <button class="ui basic button" onclick="loadSection('essays')">Essays ({{ num_essays }})</button>
        <button class="ui basic button" onclick="loadSection('bio')">{{ site.bio-page-label }}</button>
        <button class="ui basic button dark-mode-toggle" onclick="toggleDarkMode()" title="Toggle Dark Mode">
          <span class="theme-text">Light Mode</span> <i class="lightbulb icon"></i>
        </button>
      </div>
    </div>
  </div>

</div>

<!-- Dynamic content area -->
<div id="dynamic-content" class="ui container" style="margin-top: 50px; display: none;">
  <div class="ui segment">
    <div id="content-loader" class="ui active centered inline loader" style="display: none;"></div>
    <div id="content-area">
      <!-- Pre-rendered content sections (hidden by default) -->
      <div id="projects-section" class="content-section" style="display: none;">
        <h2 class="ui header">Projects</h2>
        {% include content-projects.html %}
      </div>

      <div id="papers-section" class="content-section" style="display: none;">
        <h2 class="ui header">Papers</h2>
        {% include content-papers.html %}
      </div>

      <div id="essays-section" class="content-section" style="display: none;">
        <h2 class="ui header">Essays</h2>
        {% include content-essays.html %}
      </div>

      <div id="bio-section" class="content-section" style="display: none;">
        <h2 class="ui header">Resume</h2>
        {% include content-bio.html %}
      </div>
    </div>
  </div>
</div>

<style>
  /* Smooth transitions for content loading */
  #dynamic-content {
    transition: opacity 0.3s ease-in-out;
  }

  .content-section {
    animation: fadeIn 0.4s ease-in-out;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }

    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Active button styling - with dark mode support */
  .homepage-buttons-container button.active {
    background-color: var(--cambridge-blue) !important;
    color: var(--english-violet) !important;
  }

  /* Smooth button hover effects */
  .homepage-buttons-container button {
    transition: all 0.2s ease;
  }

  .homepage-buttons-container button:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 8px var(--shadow-color);
  }

  /* Dynamic content area styling with dark mode support */
  #dynamic-content {
    background-color: var(--bg-primary) !important;
  }

  #dynamic-content .ui.container {
    background-color: var(--bg-secondary) !important;
    border: 1px solid var(--border-color) !important;
    border-radius: 8px !important;
    box-shadow: 0 2px 12px var(--shadow-color) !important;
    padding: 40px !important;
  }

  #dynamic-content .ui.segment {
    background-color: transparent !important;
    border: none !important;
    box-shadow: none !important;
    padding: 0 !important;
  }

  /* Content sections styling */
  .content-section {
    background-color: transparent !important;
  }

  .content-section .ui.header {
    color: var(--text-primary) !important;
    margin-bottom: 30px !important;
  }

  /* Ensure all cards in dynamic content inherit theme */
  #dynamic-content .ui.card {
    background-color: var(--bg-secondary) !important;
    border: 1px solid var(--border-color) !important;
    box-shadow: 0 2px 8px var(--shadow-color) !important;
  }

  #dynamic-content .ui.card .header {
    color: var(--text-primary) !important;
  }

  #dynamic-content .ui.card .meta {
    color: var(--text-secondary) !important;
  }

  #dynamic-content .ui.card .description {
    color: var(--text-primary) !important;
  }

  /* Buttons in dynamic content */
  #dynamic-content .ui.button {
    background-color: var(--cambridge-blue) !important;
    color: var(--english-violet) !important;
    border: 1px solid var(--slate-gray) !important;
  }

  #dynamic-content .ui.button:hover {
    background-color: var(--slate-gray) !important;
    color: var(--honeydew) !important;
  }

  #dynamic-content .ui.basic.button {
    background-color: transparent !important;
    color: var(--text-primary) !important;
    border: 1px solid var(--border-color) !important;
  }

  #dynamic-content .ui.basic.button:hover {
    background-color: var(--cambridge-blue) !important;
    color: var(--english-violet) !important;
  }
</style>

<script>
  // Content loading functionality
  let currentSection = 'home';

  function loadSection(section) {
    const contentArea = document.getElementById('dynamic-content');
    const loader = document.getElementById('content-loader');

    // Update button states and URL
    updateButtonStates(section);
    updateURL(section);

    if (section === 'home') {
      contentArea.style.display = 'none';
      currentSection = 'home';
      // Smooth scroll to top
      window.scrollTo({ top: 0, behavior: 'smooth' });
      return;
    }

    // Show loading state
    contentArea.style.display = 'block';
    loader.style.display = 'block';

    // Hide all content sections
    const allSections = document.querySelectorAll('.content-section');
    allSections.forEach(s => s.style.display = 'none');

    // Simulate loading and then show content
    setTimeout(() => {
      loader.style.display = 'none';
      const targetSection = document.getElementById(section + '-section');
      if (targetSection) {
        targetSection.style.display = 'block';
      }
      currentSection = section;

      // Smooth scroll to content area
      contentArea.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }, 300);
  }

  function updateButtonStates(activeSection) {
    const buttons = document.querySelectorAll('.homepage-buttons-container button:not(.dark-mode-toggle)');
    buttons.forEach(button => {
      button.classList.remove('active');
    });

    if (activeSection !== 'home') {
      const activeButton = document.querySelector(`button[onclick="loadSection('${activeSection}')"]`);
      if (activeButton) {
        activeButton.classList.add('active');
      }
    }
  }

  // Initialize on page load
  document.addEventListener('DOMContentLoaded', function () {
    // Check if there's a hash in the URL to load a specific section
    const hash = window.location.hash.substring(1);
    if (hash && ['projects', 'papers', 'essays', 'bio'].includes(hash)) {
      loadSection(hash);
    } else {
      currentSection = 'home';
    }
  });

  // Update URL hash when section changes
  function updateURL(section) {
    if (section === 'home') {
      history.replaceState(null, null, window.location.pathname);
    } else {
      history.replaceState(null, null, '#' + section);
    }
  }
</script>